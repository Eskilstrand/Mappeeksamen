color = as.factor(id))) +
geom_point() +
labs(x = ("Relativ VO2maks"),
y = ("Wattmaks/kg"),
title = "Korrelasjon mellom Vo2maks og Wattmaks",
subtitle = "Verdier er delt på vekt")
df %>%
mutate(rel.vo2max = vo2.max / weight) %>%
mutate(w.max.kg = w.max / weight) %>%
ggplot(aes(x = rel.vo2max,
y = w.max.kg,
color = as.factor(id))) +
geom_point() +
labs(x = ("Relativ VO2maks"),
y = ("Wattmaks/kg"),
title = "Korrelasjon mellom Vo2maks og Wattmaks",
subtitle = "Verdier er delt på vekt") +
geom_smooth(method = lm, se = FALSE)
df %>%
mutate(rel.vo2max = vo2.max / weight) %>%
mutate(w.max.kg = w.max / weight) %>%
ggplot(aes(x = rel.vo2max,
y = w.max.kg,
color = as.factor(id))) +
geom_point() +
labs(x = ("Relativ VO2maks"),
y = ("Wattmaks/kg"),
title = "Korrelasjon mellom Vo2maks og Wattmaks",
subtitle = "Verdier er delt på vekt")
df %>%
mutate(rel.vo2max = vo2.max / weight) %>%
mutate(w.max.kg = w.max / weight) %>%
ggplot(aes(x = rel.vo2max,
y = w.max,
color = as.factor(id))) +
geom_point() +
labs(x = ("Relativ VO2maks"),
y = ("Wattmaks/kg"),
title = "Korrelasjon mellom Vo2maks og Wattmaks",
subtitle = "Verdier er delt på vekt")
df %>%
mutate(rel.vo2max = vo2.max / weight) %>%
mutate(w.max.kg = w.max / weight) %>%
ggplot(aes(x = rel.vo2max,
y = w.max,
color = as.factor(id))) +
geom_point() +
labs(x = ("Relativ VO2maks"),
y = ("Wattmaks/kg"),
title = "Korrelasjon mellom Vo2maks og Wattmaks",
subtitle = "Verdier er delt på vekt") +
geom_smooth()
df %>%
mutate(rel.vo2max = vo2.max / weight) %>%
mutate(w.max.kg = w.max / weight) %>%
ggplot(aes(x = rel.vo2max,
y = w.max,
color = as.factor(id))) +
geom_point() +
labs(x = ("Relativ VO2maks"),
y = ("Wattmaks/kg"),
title = "Korrelasjon mellom Vo2maks og Wattmaks",
subtitle = "Verdier er delt på vekt") +
geom_smooth(method = lm)
df %>%
mutate(rel.vo2max = vo2.max / weight) %>%
mutate(w.max.kg = w.max / weight) %>%
ggplot(aes(x = rel.vo2max,
y = w.max,
color = as.factor(id))) +
geom_point() +
labs(x = ("Relativ VO2maks"),
y = ("Wattmaks/kg"),
title = "Korrelasjon mellom Vo2maks og Wattmaks",
subtitle = "Verdier er delt på vekt") +
geom_smooth(method = lm, na.rm = TRUE)
df %>%
mutate(rel.vo2max = vo2.max / weight) %>%
mutate(w.max.kg = w.max / weight) %>%
ggplot(aes(x = rel.vo2max,
y = w.max,
color = as.factor(id))) +
geom_point() +
labs(x = ("Relativ VO2maks"),
y = ("Wattmaks/kg"),
title = "Korrelasjon mellom Vo2maks og Wattmaks",
subtitle = "Verdier er delt på vekt")
df %>%
mutate(rel.vo2max = vo2.max / weight) %>%
mutate(w.max.kg = w.max / weight) %>%
ggplot(aes(x = rel.vo2max,
y = w.max,
color = as.factor(id))) +
geom_point() +
labs(x = ("Relativ VO2maks"),
y = ("Wattmaks/kg"),
title = "Korrelasjon mellom Vo2maks og Wattmaks",
subtitle = "Verdier er delt på vekt") +
geom_smooth(method = "lm")
mutate(rel.vo2max = vo2.max / weight) %>%
mutate(w.max.kg = w.max / weight) %>%
ggplot(aes(x = rel.vo2max,
y = w.max,
color = as.factor(id))) +
geom_point() +
labs(x = ("Relativ VO2maks"),
y = ("Wattmaks/kg"),
title = "Korrelasjon mellom Vo2maks og Wattmaks",
subtitle = "Verdier er delt på vekt") +
geom_smooth(method = "lm")
df %>%
filter(timepoint == "t1") |>
mutate(rel.vo2max = vo2.max / weight) %>%
mutate(w.max.kg = w.max / weight) %>%
ggplot(aes(x = rel.vo2max,
y = w.max,
color = as.factor(id))) +
geom_point() +
labs(x = ("Relativ VO2maks"),
y = ("Wattmaks/kg"),
title = "Korrelasjon mellom Vo2maks og Wattmaks",
subtitle = "Verdier er delt på vekt") +
geom_smooth(method = "lm")
df %>%
filter(timepoint == "t1") |>
mutate(rel.vo2max = vo2.max / weight) %>%
mutate(w.max.kg = w.max / weight) %>%
ggplot(aes(x = rel.vo2max,
y = w.max,
color = as.factor(id))) +
geom_point() +
labs(x = ("Relativ VO2maks"),
y = ("Wattmaks/kg"),
title = "Korrelasjon mellom Vo2maks og Wattmaks",
subtitle = "Verdier er delt på vekt") +
geom_smooth(method = "lm", color = "brown")
df %>%
filter(timepoint == "t1") |>
mutate(rel.vo2max = vo2.max / weight) %>%
mutate(w.max.kg = w.max / weight) %>%
ggplot(aes(x = rel.vo2max,
y = w.max,
color = as.factor(id))) +
geom_point() +
labs(x = ("Relativ VO2maks"),
y = ("Wattmaks"),
title = "Korrelasjon mellom Vo2maks og Wattmaks",
subtitle = "Verdier er delt på vekt") +
geom_smooth(method = "lm", se = FALSE, color = "brown")
df %>%
filter(timepoint == "t1") |>
mutate(rel.vo2max = vo2.max / weight) %>%
mutate(w.max.kg = w.max / weight) %>%
ggplot(aes(x = rel.vo2max,
y = w.max,
color = as.factor(id))) +
geom_point() +
labs(x = ("Relativ VO2maks"),
y = ("Wattmaks"),
title = "Korrelasjon mellom sd(VO<sub>2maks</sub> og Wattmaks",
subtitle = "Verdier er delt på vekt") +
geom_smooth(method = "lm", se = FALSE, color = "brown")
df %>%
filter(timepoint == "t1") |>
mutate(rel.vo2max = vo2.max / weight) %>%
mutate(w.max.kg = w.max / weight) %>%
ggplot(aes(x = rel.vo2max,
y = w.max,
color = as.factor(id))) +
geom_point() +
labs(x = ("Relativ VO2maks"),
y = ("Wattmaks"),
title = "Korrelasjon mellom VO~2maks~ og Wattmaks",
subtitle = "Verdier er delt på vekt") +
geom_smooth(method = "lm", se = FALSE, color = "brown")
df %>%
filter(timepoint == "t1") |>
mutate(rel.vo2max = vo2.max / weight) %>%
mutate(w.max.kg = w.max / weight) %>%
ggplot(aes(x = rel.vo2max,
y = w.max,
color = as.factor(id))) +
geom_point() +
labs(x = ("Relativ VO2maks"),
y = ("Wattmaks"),
title = sd("Korrelasjon mellom VO<sub>2maks</sub> og Wattmaks"),
subtitle = "Verdier er delt på vekt") +
geom_smooth(method = "lm", se = FALSE, color = "brown")
# Chunk 1
#| code-fold: true
#| message: false
#| warning: false
library(readxl)
library(tidyverse)
library(ggplot2)
library(dplyr)
library(magrittr)
library(gt)
library(ggtext)
df <- read_xlsx("data/o2-test.xlsx")
# Chunk 2
#| tbl-cap: "Tabellen viser hver deltakers gjennomsnitt og standardavvik i ()"
#| code-fold: true
#| message: false
#| warning: false
#Last inn datasettet
df.tbl <- df |>
#Velg hvilke variabler som skal med videre
select(id, timepoint, weight, w.max:borg.max) |>
#Fjern verdiene som har characters
select(-hr.max) |>
select(-la.max) |>
select(-bf.max) |>
select(-vco2.max) |>
select(-rer.max) |>
select(-ve.max) |>
#Lag nye verdier, relativ vo2maks og wattmaks/kg
mutate(rel.vo2max = vo2.max / weight) |>
mutate(rel.wmax = w.max / weight) |>
#Sliter fortsatt med å forklare pivot både longer og wider
pivot_longer(names_to = "ID",
values_to = "verdier",
cols = w.max:rel.wmax) |>
#Grupper etter id og names
group_by(id, ID) |>
#Summarise gjennomsnitt og standardavvik til verdiene
summarise(m = mean(verdier),
s = sd(verdier)) |>
mutate(m_s = paste0(signif(m, 3), " (", signif(s, 2), ")")) %>%
ungroup() |>
select(-m, -s) |>
pivot_wider(names_from = "id",
values_from = "m_s") |>
gt()
df.tbl |>
text_replace(
pattern = "^bf.max$",
replacement = md("Bf<small>(maks)</small>")) |>
text_replace(
pattern = "^borg.max$",
replacement = md("Borg<small>(maks)</small>")) |>
text_replace(
pattern = "^rel.vo2max$",
replacement = md("VO<sub>2maks</sub><br><small>(ml/kg/min)</br></small>")) |>
text_replace(
pattern = "^rel.wmax$",
replacement = md("Wattmaks/kg")) |>
text_replace(
pattern = "^vo2.max",
replacement = md("VO<sub>2maks</sub><br><small>(ml/min)</br></small>")) |>
text_replace(
pattern = "w.max$",
replacement = ("Wattmaks")) |>
tab_options(table.font.size = 10)
# Chunk 3
#| code-fold: true
df.rel <- df |>
select(id, timepoint, weight, vo2.max, w.max) |>
mutate(rel.vo2 = vo2.max / weight) |>
mutate(rel.wmax = w.max / weight)
# Chunk 4
#| code-fold: true
#| tbl-cap: "Reliability relativ vo2maks T1&T2"
df.rel |>
#velger hvilke variabler vi er interessert i å se på
select(id, timepoint, rel.vo2) |>
#benytter oss av pivot_wider for å lage tidy_data
pivot_wider(names_from = timepoint,
values_from = rel.vo2) |>
mutate(diff = t2 - t1) |>
summarise(MEAN = mean(c(t1, t2), na.rm = TRUE),
SD = sd(diff, na.rm = TRUE),
TE = SD / sqrt(2),
CV = TE/MEAN * 100) |>
gt() |>
fmt_number(decimals = 2)
cv_perct1_t2 <- 2.47
# Chunk 5
#| code-fold: true
#| tbl-cap: "Reliability relativ vo2maks T3&T4"
df.rel |>
#velger hvilke variabler vi er interessert i å se på
select(id, timepoint, rel.vo2) |>
#benytter oss av pivot_wider for å lage tidy_data
pivot_wider(names_from = timepoint,
values_from = rel.vo2) |>
mutate(diff = t4 - t3) |>
summarise(MEAN = mean(c(t3, t4), na.rm = TRUE),
SD = sd(diff, na.rm = TRUE),
TE = SD / sqrt(2),
CV = TE/MEAN * 100) |>
gt() |>
fmt_number(decimals = 2)
cv_perct3_t4 <- 4.78
# Chunk 6
#| code-fold: true
#| message: false
#| warning: false
#| fig-cap: "Figur 1: Hvert punkt = én observasjon"
df %>%
filter(timepoint == "t1") |>
mutate(rel.vo2max = vo2.max / weight) %>%
mutate(w.max.kg = w.max / weight) %>%
ggplot(aes(x = rel.vo2max,
y = w.max,
color = as.factor(id))) +
geom_point() +
labs(x = ("Relativ VO2maks"),
y = ("Wattmaks"),
title = sd("Korrelasjon mellom VO<sub>2maks</sub> og Wattmaks"),
subtitle = "Verdier er delt på vekt") +
geom_smooth(method = "lm", se = FALSE, color = "brown")
df %>%
filter(timepoint == "t1") |>
mutate(rel.vo2max = vo2.max / weight) %>%
mutate(w.max.kg = w.max / weight) %>%
ggplot(aes(x = rel.vo2max,
y = w.max,
color = as.factor(id))) +
geom_point() +
labs(x = ("Relativ VO2maks"),
y = ("Wattmaks"),
title = "Korrelasjon mellom VO<sub>2maks</sub> og Wattmaks",
subtitle = "Verdier er delt på vekt") +
geom_smooth(method = "lm", se = FALSE, color = "brown")
df %>%
filter(timepoint == "t1") |>
mutate(rel.vo2max = vo2.max / weight) %>%
mutate(w.max.kg = w.max / weight) %>%
ggplot(aes(x = rel.vo2max,
y = w.max,
color = as.factor(id))) +
geom_point() +
labs(x = ("Relativ VO2maks"),
y = ("Wattmaks"),
title = "Korrelasjon mellom VO<sub>2maks</sub> og Wattmaks",
subtitle = "Verdier er delt på vekt") +
geom_smooth(method = "lm", se = FALSE, color = "brown")
# Chunk 1
#| code-fold: true
#| message: false
#| warning: false
library(readxl)
library(tidyverse)
library(ggplot2)
library(dplyr)
library(magrittr)
library(gt)
library(ggtext)
df <- read_xlsx("data/o2-test.xlsx")
# Chunk 2
#| tbl-cap: "Tabellen viser hver deltakers gjennomsnitt og standardavvik i ()"
#| code-fold: true
#| message: false
#| warning: false
#Last inn datasettet
df.tbl <- df |>
#Velg hvilke variabler som skal med videre
select(id, timepoint, weight, w.max:borg.max) |>
#Fjern verdiene som har characters
select(-hr.max) |>
select(-la.max) |>
select(-bf.max) |>
select(-vco2.max) |>
select(-rer.max) |>
select(-ve.max) |>
#Lag nye verdier, relativ vo2maks og wattmaks/kg
mutate(rel.vo2max = vo2.max / weight) |>
mutate(rel.wmax = w.max / weight) |>
#Sliter fortsatt med å forklare pivot både longer og wider
pivot_longer(names_to = "ID",
values_to = "verdier",
cols = w.max:rel.wmax) |>
#Grupper etter id og names
group_by(id, ID) |>
#Summarise gjennomsnitt og standardavvik til verdiene
summarise(m = mean(verdier),
s = sd(verdier)) |>
mutate(m_s = paste0(signif(m, 3), " (", signif(s, 2), ")")) %>%
ungroup() |>
select(-m, -s) |>
pivot_wider(names_from = "id",
values_from = "m_s") |>
gt()
df.tbl |>
text_replace(
pattern = "^bf.max$",
replacement = md("Bf<small>(maks)</small>")) |>
text_replace(
pattern = "^borg.max$",
replacement = md("Borg<small>(maks)</small>")) |>
text_replace(
pattern = "^rel.vo2max$",
replacement = md("VO<sub>2maks</sub><br><small>(ml/kg/min)</br></small>")) |>
text_replace(
pattern = "^rel.wmax$",
replacement = md("Wattmaks/kg")) |>
text_replace(
pattern = "^vo2.max",
replacement = md("VO<sub>2maks</sub><br><small>(ml/min)</br></small>")) |>
text_replace(
pattern = "w.max$",
replacement = ("Wattmaks")) |>
tab_options(table.font.size = 10)
# Chunk 3
#| code-fold: true
df.rel <- df |>
select(id, timepoint, weight, vo2.max, w.max) |>
mutate(rel.vo2 = vo2.max / weight) |>
mutate(rel.wmax = w.max / weight)
# Chunk 4
#| code-fold: true
#| tbl-cap: "Reliability relativ vo2maks T1&T2"
df.rel |>
#velger hvilke variabler vi er interessert i å se på
select(id, timepoint, rel.vo2) |>
#benytter oss av pivot_wider for å lage tidy_data
pivot_wider(names_from = timepoint,
values_from = rel.vo2) |>
mutate(diff = t2 - t1) |>
summarise(MEAN = mean(c(t1, t2), na.rm = TRUE),
SD = sd(diff, na.rm = TRUE),
TE = SD / sqrt(2),
CV = TE/MEAN * 100) |>
gt() |>
fmt_number(decimals = 2)
cv_perct1_t2 <- 2.47
# Chunk 5
#| code-fold: true
#| tbl-cap: "Reliability relativ vo2maks T3&T4"
df.rel |>
#velger hvilke variabler vi er interessert i å se på
select(id, timepoint, rel.vo2) |>
#benytter oss av pivot_wider for å lage tidy_data
pivot_wider(names_from = timepoint,
values_from = rel.vo2) |>
mutate(diff = t4 - t3) |>
summarise(MEAN = mean(c(t3, t4), na.rm = TRUE),
SD = sd(diff, na.rm = TRUE),
TE = SD / sqrt(2),
CV = TE/MEAN * 100) |>
gt() |>
fmt_number(decimals = 2)
cv_perct3_t4 <- 4.78
# Chunk 6
#| code-fold: true
#| message: false
#| warning: false
#| fig-cap: "Figur 1: Hvert punkt = én observasjon"
df %>%
filter(timepoint == "t1") |>
mutate(rel.vo2max = vo2.max / weight) %>%
mutate(w.max.kg = w.max / weight) %>%
ggplot(aes(x = rel.vo2max,
y = w.max,
color = as.factor(id))) +
geom_point() +
labs(x = ("Relativ VO2maks"),
y = ("Wattmaks"),
title = "Korrelasjon mellom VO<sub>2maks</sub> og Wattmaks",
subtitle = "Verdier er delt på vekt") +
geom_smooth(method = "lm", se = FALSE, color = "brown")
df %>%
filter(timepoint == "t1") |>
mutate(rel.vo2max = vo2.max / weight) %>%
mutate(w.max.kg = w.max / weight) %>%
ggplot(aes(x = rel.vo2max,
y = w.max,
color = as.factor(id))) +
geom_point() +
labs(x = ("Relativ VO2maks"),
y = ("Wattmaks"),
title = "Korrelasjon mellom VO~2maks~ og Wattmaks",
subtitle = "Verdier er delt på vekt") +
geom_smooth(method = "lm", se = FALSE, color = "brown")
df %>%
filter(timepoint == "t1") |>
mutate(rel.vo2max = vo2.max / weight) %>%
mutate(w.max.kg = w.max / weight) %>%
ggplot(aes(x = rel.vo2max,
y = w.max,
color = as.factor(id))) +
geom_point() +
labs(x = ("Relativ VO2maks"),
y = ("Wattmaks"),
title = "Korrelasjon mellom **VO2maks** og Wattmaks",
subtitle = "Verdier er delt på vekt") +
geom_smooth(method = "lm", se = FALSE, color = "brown")
df %>%
filter(timepoint == "t1") |>
mutate(rel.vo2max = vo2.max / weight) %>%
mutate(w.max.kg = w.max / weight) %>%
ggplot(aes(x = rel.vo2max,
y = w.max,
color = as.factor(id))) +
geom_point() +
labs(x = ("Relativ VO2maks"),
y = ("Wattmaks"),
title = "Korrelasjon mellom VO<sub>2maks</sub> og Wattmaks") +
geom_smooth(method = "lm", se = FALSE, color = "brown")
df %>%
filter(timepoint == "t1") |>
mutate(rel.vo2max = vo2.max / weight) %>%
mutate(w.max.kg = w.max / weight) %>%
ggplot(aes(x = rel.vo2max,
y = w.max,
color = as.factor(id))) +
geom_point() +
labs(x = ("Relativ VO2maks"),
y = ("Wattmaks"),
title = "Korrelasjon mellom VO2maks og Wattmaks") +
geom_smooth(method = "lm", se = FALSE, color = "brown")
